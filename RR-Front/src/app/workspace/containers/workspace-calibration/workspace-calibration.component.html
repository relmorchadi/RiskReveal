<app-left-menu></app-left-menu>
<div class="plt-browser-wrapper">
  <div class="a-app-wrapper">
    <div class="a-app-header">
      <h4>Calibration Editor</h4>
    </div>

    <div class="my-tabs" style="margin-bottom: 10px;">
      <div *ngIf="!collapsedTags" class="noMargin row" style="position: relative;width: 175px;">
        <div class="col-10" style="padding:unset; position: absolute;min-width: 175px">
          <app-plt-left-menu
            [menuInputs]="{
            tagContextMenu: tagContextMenu,
            wsId: workspaceId,
            uwYear: uwy,
            projects: projects,
            showDeleted: showDeleted,
            filterData: filterData,
            filters: filters,
            addTagModalIndex: tagModalIndex,
            fromPlts: fromPlts,
            deletedPltsLength: (listOfDeletedPlts | keys).length,
            userTags: userTags,
            systemTags: systemTags,
            selectedListOfPlts: selectedListOfPlts,
            systemTagsCount: systemTagsCount,
            _tagModalVisible: tagModalVisible,
            _editingTag: editingTag,
            _modalSelect: modalSelect,
            tagForMenu: tagForMenu,
            wsHeaderSelected: wsHeaderSelected,
            pathTab:false
          }"
            (onAssignPltsToTag)="assignPltsToTag($event)"
            (onCreateTag)="createTag($event)"
            (onProjectFilter)="filter($event)"
            (onEditTag)="editTag()"
            (onResetPath)="resetPath()"
            (onSelectProjects)="setSelectedProjects($event)"
            (onSelectSysTagCount)="selectSystemTag($event)"
            (onSetFilters)="setFilters($event)"
            (onSetFromPlts)="setFromPlts($event)"
            (onSetSelectedUserTags)="setUserTags($event)"
            (onToggleDeletedPlts)="toggleDeletePlts($event)"
            (setTagModalIndex)="setModalIndex($event)"
            (setTagModalVisibility)="setTagModal($event)"
            (onSetTagForMenu)="setTagForMenu($event)"
            (onSetRenameTag)="setRenameTag($event)"
            (emitFilters)="emitFilters($event)"
            (unCkeckAllPlts)="unCheckAll()"
            (onWsHeaderSelection)="setWsHeaderSelect($event)"
            (onModalSelect)="setModalSelectedItems($event)"
          ></app-plt-left-menu>
        </div>
        <div class="collapseTags col-2" style="padding:10px 0px 0px 145px; position: absolute;width: 16.6666%">
          <i *ngIf="!collapsedTags" (click)="collapseTags()" class="icon-chevron_left_24px"
             style="font-size: 25px; cursor: pointer"></i>
        </div>
      </div>
      <div *ngIf="collapsedTags" class="noMargin row" style="position: relative;width: 37px;height:44px">
        <div class="collapseTags col-2" style="padding:10px 0px 0px 5px; position: absolute;">
          <i (click)="collapseTags()" class="icon-chevron_right_24px"
             style="font-size: 25px; cursor: pointer"></i>
        </div>
      </div>
      <div class="tabset-right" style="flex: 1;background: #fff;">
        <div>
          <div class="PLTs-content">
            <p-contextMenu #cm appendTo="body" [model]="contextMenuItems"></p-contextMenu>
            <p-table
              [columns]="dataColumns"
              [frozenColumns]="frozenColumns"
              [frozenWidth]="frozenWidth"
              [value]="(showDeleted ? deletedPlts : listOfPltsData) | tableSortAndFilter : [sortData,filterData] | systemTagFilter: [filters.systemTag]"
              [resizableColumns]="true"
              [contextMenu]="cm"
              [scrollHeight]="'600px'"
              [scrollable]="true"
              [totalRecords]="listOfPltsData.length"
              (onSort)="onSort($event)"
              [responsive]="true"
            >
              <ng-template pTemplate="colgroup" let-columns>
                <colgroup>
                  <col *ngFor="let col of columns"
                       [ngStyle]="{'width': col?.width+'px','max-width':col.fields == 'default' ? col?.width+'px' : ''}">
                </colgroup>
              </ng-template>
              <ng-template pTemplate="header" let-columns>
                <tr style="background-color: #ffffff !important;">
                  <ng-container *ngFor="let col of columns;">
                    <th *ngIf="col?.fields === 'checkbox'" [ngStyle]="{'width': '43px','overflow':'visible'}"
                        class="checkBoxHead"
                        style="background-color: #ffffff !important;height: 70px!important; padding: 0;">
                      <div
                        style="width: 102px;position: absolute;left: -1px;top: 2px;margin-right: 3px; border-top: 3px solid #0700e4;">
                        <span
                          style="width: 90px; font-size: 1.3em; font-weight: bold;     color: rgba(0, 0, 0, 0.65);top: 16px;left: 33px;position: absolute;">PLTs</span>
                      </div>
                      <div style="left: -1px;top: 32px; position:absolute; margin-right: 3px;">
                        <span
                          class="addRemove">Add/Remove</span>
                      </div>
                      <nz-dropdown [nzPlacement]="'bottomLeft'"
                                   style="position: absolute; left: 77px; top: 20px;">
                        <i class="icon-menu_24px" nz-dropdown
                           style="font-size: 25px; float: right; margin-right: 7px"></i>
                        <ul nz-menu>
                          <li nz-submenu>
                            <span title>Create</span>
                            <ul nz-menu>
                              <li nz-menu-item>New Default Thread</li>
                              <li nz-menu-item>New Non-default Thread</li>
                            </ul>
                          </li>
                          <li nz-submenu>
                            <span title>Clone</span>
                            <ul nz-menu>
                              <li nz-menu-item>New Default Thread</li>
                              <li nz-menu-item>New Non-default Thread</li>
                            </ul>
                          </li>
                          <li nz-submenu>
                            <span title>Regenerate</span>
                            <ul nz-menu>
                              <li nz-menu-item *ngIf="selectedListOfPlts.length > 1">Selected Threads Only</li>
                              <li nz-menu-item>All Threads</li>
                            </ul>
                          </li>
                          <li nz-menu-item>Remove</li>
                          <li nz-menu-item>Manage Tags</li>
                          <li nz-menu-item>Edit PLT Name</li>
                          <li nz-menu-item>Publish to Princing</li>
                          <li nz-menu-item>Publish to Accumulation</li>
                          <li nz-submenu>
                            <span title>Inuring</span>
                            <ul nz-menu>
                              <li nz-menu-item>Add to New Inuring Package</li>
                              <li nz-menu-item>Add to Existing Inuring Package</li>
                            </ul>
                          </li>
                          <li nz-menu-item>Add to Comparer</li>
                          <li nz-menu-item>Export</li>
                          <li nz-menu-item>Delete</li>
                        </ul>
                      </nz-dropdown>
                    </th>
                    <th *ngIf="col?.fields === 'userTags'" [ngStyle]="{'width': '60px'}"
                        style="background-color: #ffffff !important;height: 70px!important;">
                    </th>
                    <th *ngIf="col?.fields === 'pltId'"
                        style="background-color: #ffffff !important;height: 70px!important;">
                    </th>
                    <th *ngIf="col?.fields === 'pltName'"
                        style="background-color: #ffffff !important;height: 70px!important;">
                    </th>
                    <ng-container
                      *ngIf="extended && (col.fields === 'rap' || col.fields === 'vendorSystem'|| col.fields === 'grain'|| col.fields === 'regionPerilName'|| col.fields === 'regionPerilCode'|| col.fields === 'peril')">
                      <th style="background-color: #ffffff !important;"></th>
                    </ng-container>
                    <th *ngIf="col?.icon === 'icon-focus-add'"
                        style="background-color: #ffffff !important;height: 70px!important;">
                    </th>
                    <th *ngIf="col?.icon === 'icon-note'" class="separator-right"
                        style="background-color: #ffffff !important;height: 70px!important;padding: 10px 0 0 0;position:relative">
                      <i *ngIf="!extended" (click)="extend()" class="icon-chevron_right_24px"
                         style="font-size: 25px; cursor: pointer;color: rgba(0, 0, 0, 0.65);position: absolute;right: 3px;"></i>
                      <i *ngIf="extended" (click)="extend()" class="icon-chevron_left_24px"
                         style="font-size: 25px; cursor: pointer;color: rgba(0, 0, 0, 0.65);position: absolute;right: 3px;"></i>
                    </th>
                    <th *ngIf="col.fields == 'overallLMF' && !extended"
                        [ngStyle]="{'width': '43px','overflow':'visible'}"
                        class="checkBoxHead"
                        style="background-color: #ffffff !important;height: 70px!important; padding: 0;">
                      <div
                        style="width: 180px;position: absolute;top: 2px;margin-right: 3px; border-top: 3px solid #0700e4;    z-index: 100;"
                        [ngStyle]="{'left': genericWidth[0]}">

                        <span
                          style="width: 110px; font-size: 1.3em; font-weight: bold; color: rgba(0, 0, 0, 0.65);top: 16px;position: absolute;overflow: hidden;white-space: nowrap;"
                          [ngStyle]="{'left': genericWidth[1]}">Generic Thread</span>
                        <nz-dropdown [nzPlacement]="'bottomLeft'"
                                     style="position: absolute; top: 20px;z-index: 100;"
                                     [ngStyle]="{'left': genericWidth[2]}">
                          <i class="icon-menu_24px" nz-dropdown
                             style="font-size: 25px; float: right; margin-right: 7px"></i>
                          <ul nz-menu>
                            <li nz-menu-item (click)="clickButtonPlus(true)">Add New Adjustment</li>
                            <li nz-menu-item>Add from Template</li>
                            <li nz-menu-item>Reset/Clear</li>
                            <li nz-menu-item>Save</li>
                            <li nz-menu-item>Save As</li>
                            <li nz-submenu>
                              <span title>Apply</span>
                              <ul nz-menu>
                                <li nz-submenu>
                                  <span title>Create New Alternate Threads</span>
                                  <ul nz-menu>
                                    <li nz-menu-item>For Selected Threads only</li>
                                    <li nz-menu-item>For All Threads</li>
                                  </ul>
                                </li>
                                <li nz-submenu>
                                  <span title>Replace Existing Threads</span>
                                  <ul nz-menu>
                                    <li nz-menu-item>For Selected Threads only</li>
                                    <li nz-menu-item>For All Threads</li>
                                  </ul>
                                </li>
                              </ul>
                            </li>
                          </ul>
                        </nz-dropdown>
                      </div>

                      <div
                        *ngIf="adjsArray.length > 0"
                        dnd-sortable-container [sortableData]="adjsArray" [dropZones]="['widget-dropZone']"
                        style="position: absolute; left: 604px; width: calc(100% - 614px);z-index: 100; top: 14px;border: 1px solid #dddddd; height: 44px;overflow-x: auto;overflow-y: hidden;white-space: nowrap;">
                        <ng-container *ngFor="let adj of adjsArray;let adjIndex=index">
                          <div class="adjustDiv" [ngStyle]="{'margin-left' :'5px'}"
                               (mouseover)="shownDropDown = adj.id"
                               dnd-sortable
                               [sortableIndex]="adjIndex"
                               [dragEnabled]="true"
                               (click)="selectedAdjust(adj.id)"
                               [ngClass]="{'selectedAdjustment':selectedAdjustment===adj.id}"
                               [dragData]="adj" (onDropSuccess)="dropThreadAdjustment()">
                            <span
                              style="font-weight: normal !important;text-overflow: ellipsis;max-width: 85px;overflow: hidden;display:inline-block;">{{adj?.name}}</span>
                            <nz-dropdown *ngIf="shownDropDown === adj.id" [nzPlacement]="'bottomLeft'" class="dropD">
                              <i class="icon-menu_24px" nz-dropdown
                                 style="font-size: 14px;float: right;margin-right: 2px;"></i>
                              <ul nz-menu>
                                <li nz-menu-item (click)="ModifyAdjustement(adj)">Edit</li>
                                <li nz-menu-item (click)="DeleteAdjustement(adj)">Duplicate</li>
                                <li nz-menu-item (click)="DeleteAdjustement(adj)">Delete</li>
                                <li nz-submenu>
                                  <span title>Apply</span>
                                  <ul nz-menu>
                                    <li nz-submenu>
                                      <span title>Create New Alternate Threads</span>
                                      <ul nz-menu>
                                        <li nz-menu-item (click)="applyToSelected(adj)">For Selected Threads only</li>
                                        <li nz-menu-item (click)="applyToAll(adj)">For All Threads</li>
                                      </ul>
                                    </li>
                                    <li nz-submenu>
                                      <span title>Replace Existing Threads</span>
                                      <ul nz-menu>
                                        <li nz-menu-item (click)="replaceToSelectedPlt(adj)">For Selected Threads only
                                        </li>
                                        <li nz-menu-item (click)="replaceToAllAdjustement(adj)">For All Threads</li>
                                      </ul>
                                    </li>
                                  </ul>
                                </li>
                              </ul>
                            </nz-dropdown>
                            <input (change)="onChangeAdjValue(adj,$event)" [disabled]="adj.linear" [value]="adj.value"
                                   class="templateInput"
                            >
                          </div>
                        </ng-container>
                      </div>
                    </th>
                    <th *ngIf="col?.dragable && !extended"
                        style="background-color: #ffffff !important;height: 70px!important;">
                    </th>

                    <th *ngIf="col.fields == 'overallLMF' && extended"
                        style="background-color: #ffffff !important; height: 70px!important;  position: relative; padding: 0;"
                        colspan="6">
                      <div
                        style="position: absolute;left: -1px;top: 2px;margin-right: 3px; border-top: 3px solid #0700e4;width: 180px;">
                        <span
                          style="width: 110px; font-size: 1.3em; font-weight: bold; color: #000;top: 16px;left: 33px; position: absolute">Generic Thread</span>
                      </div>
                      <nz-dropdown [nzPlacement]="'bottomLeft'"
                                   style="font-size: 20px; cursor: pointer;position: absolute;left: 156px;top: 20px;">
                        <i class="icon-menu_24px" nz-dropdown
                           style="font-size: 25px; float: right; margin-right: 7px"></i>
                        <ul nz-menu>
                          <li nz-menu-item (click)="clickButtonPlus(true)">Add New Adjustment</li>
                          <li nz-menu-item>Add from Template</li>
                          <li nz-menu-item>Reset/Clear</li>
                          <li nz-menu-item>Save</li>
                          <li nz-menu-item>Save As</li>
                          <li nz-submenu>
                            <span title>Apply</span>
                            <ul nz-menu>
                              <li nz-submenu>
                                <span title>Create New Alternate Threads</span>
                                <ul nz-menu>
                                  <li nz-menu-item>For Selected Threads only</li>
                                  <li nz-menu-item>For All Threads</li>
                                </ul>
                              </li>
                              <li nz-submenu>
                                <span title>Replace Existing Threads</span>
                                <ul nz-menu>
                                  <li nz-menu-item>For Selected Threads only</li>
                                  <li nz-menu-item>For All Threads</li>
                                </ul>
                              </li>
                            </ul>
                          </li>
                        </ul>
                      </nz-dropdown>
                      <div
                        *ngIf="adjsArray.length > 0"
                        dnd-sortable-container [sortableData]="adjsArray" [dropZones]="['widget-dropZone']"
                        style="position: absolute;left: 221px; width: calc(100% - 233px); margin-top: 14px;border: 1px solid #dddddd; height: 44px;overflow-x: auto;overflow-y: hidden;white-space: nowrap;">
                        <ng-container *ngFor="let adj of adjsArray;let adjIndex=index">
                          <div class="adjustDiv" [ngStyle]="{'margin-left' :'5px'}"
                               (mouseenter)="shownDropDown = adj.id"
                               dnd-sortable
                               [sortableIndex]="adjIndex"
                               [dragEnabled]="true"
                               (click)="selectedAdjust(adj.id)"
                               [ngClass]="{'selectedAdjustment':selectedAdjustment===adj.id}"
                               [dragData]="adj" (onDropSuccess)="dropThreadAdjustment()">
                            <span
                              style="font-weight: normal !important;text-overflow: ellipsis;max-width: 85px;overflow: hiddendisplay:inline-block;">{{adj?.name}}</span>
                            <nz-dropdown *ngIf="shownDropDown === adj.id" [nzPlacement]="'bottomLeft'" class="dropD">
                              <i class="icon-menu_24px" nz-dropdown
                                 style="font-size: 14px;float: right;margin-right: 2px;"></i>
                              <ul nz-menu>
                                <li nz-menu-item (click)="ModifyAdjustement(adj)">Edit</li>
                                <li nz-menu-item>Duplicate</li>
                                <li nz-menu-item (click)="DeleteAdjustement(adj)">Delete</li>
                                <li nz-submenu>
                                  <span title>Apply</span>
                                  <ul nz-menu>
                                    <li nz-submenu>
                                      <span title>Create New Alternate Threads</span>
                                      <ul nz-menu>
                                        <li nz-menu-item (click)="applyToSelected(adj)">For Selected Threads only</li>
                                        <li nz-menu-item (click)="applyToAll(adj)">For All Threads</li>
                                      </ul>
                                    </li>
                                    <li nz-submenu>
                                      <span title>Replace Existing Threads</span>
                                      <ul nz-menu>
                                        <li nz-menu-item (click)="replaceToSelectedPlt(adj)">For Selected Threads only
                                        </li>
                                        <li nz-menu-item (click)="replaceToAllAdjustement(adj)">For All Threads</li>
                                      </ul>
                                    </li>
                                  </ul>
                                </li>
                              </ul>
                            </nz-dropdown>
                            <input (change)="onChangeAdjValue(adj,$event)" [disabled]="adj.linear" [value]="adj.value"
                                   class="templateInput"
                            >
                          </div>
                        </ng-container>
                      </div>

                    </th>
                  </ng-container>
                </tr>
                <tr>
                  <ng-container *ngFor="let col of columns; let i = index">
                    <th *ngIf="col?.fields === 'checkbox'" [ngStyle]="{'width': '43px'}" class="checkBoxHead"
                        style="padding: 0 !important;">
                      <label nz-checkbox [nzChecked]="selectAll" (nzCheckedChange)="checkAll($event)"
                             [nzIndeterminate]="someItemsAreSelected"></label>
                      <i (click)="checkBoxsort()" style="cursor: pointer;" nz-icon nzType="down" nzTheme="outline"></i>
                    </th>
                    <th *ngIf="col?.fields === 'userTags'" [ngStyle]="{'width': '60px'}" style="padding: 0 !important;">
                      <span style="display:flex;justify-content: space-between;font-weight: bold">
                        {{col.header}}
                      </span>
                    </th>
                    <th *ngIf="col?.fields === 'pltId'" style="padding: 0 !important;">
                      <span style="display:flex;justify-content: space-between;">
                        {{col?.header}}
                        <ng-container *ngIf="col?.sorted" [ngSwitch]="sortData[col?.fields]">
                          <i *ngSwitchCase="'asc'" class="icon-keyboard_arrow_up_24px"
                             (click)="sortChange(col?.fields,sortData[col.fields])" style="font-size: 1.4em;"></i>
                          <i *ngSwitchCase="'desc'" class="icon-keyboard_arrow_down_24px"
                             (click)="sortChange(col?.fields,sortData[col.fields])" style="font-size: 1.4em;"></i>
                          <i *ngSwitchDefault class="icon-direction"
                             (click)="sortChange(col?.fields,sortData[col.fields])" style="font-size: 1.4em;"></i>
                        </ng-container>
                      </span>
                    </th>

                    <th *ngIf="col?.fields === 'pltName'" style="padding: 0 !important;">
                      <span style="display:flex;justify-content: space-between;">
                        {{col?.header}}
                        <ng-container *ngIf="col?.sorted" [ngSwitch]="sortData[col?.fields]">
                          <i *ngSwitchCase="'asc'" class="icon-keyboard_arrow_up_24px"
                             (click)="sortChange(col?.fields,sortData[col.fields])" style="font-size: 1.4em;"></i>
                          <i *ngSwitchCase="'desc'" class="icon-keyboard_arrow_down_24px"
                             (click)="sortChange(col?.fields,sortData[col.fields])" style="font-size: 1.4em;"></i>
                          <i *ngSwitchDefault class="icon-direction"
                             (click)="sortChange(col?.fields,sortData[col.fields])" style="font-size: 1.4em;"></i>
                        </ng-container>
                      </span>
                    </th>
                    <th *ngIf="col?.icon === 'icon-focus-add'" style="padding: 0 !important;">
                      <span style="display:flex;justify-content: space-between;">
                        <nz-dropdown *ngIf="col.icon === 'icon-focus-add'" [nzPlacement]="'bottomLeft'">
                        <i [ngClass]="col.icon" nz-dropdown style="font-size: 15px;"></i>
                        <ul nz-menu>
                          <li nz-menu-item>
                            <div class="checkboxInput">
                              <label [(ngModel)]="inProgressCheckbox"
                                     nzChecked
                                     nz-checkbox
                                     style="margin-right: 12px;">
                                <i class="icon-history-alt iconYellow"></i> In Progress
                              </label>
                            </div>
                          </li>
                          <li nz-menu-item>
                            <div class="checkboxInput">
                              <label [(ngModel)]="checkedCheckbox"
                                     nzChecked
                                     nz-checkbox
                                     style="margin-right: 12px;">
                                <i class="icon-check-circle iconGreen"></i> Valid
                              </label>
                            </div>
                          </li>
                          <li nz-menu-item>
                            <div class="checkboxInput">
                              <label [(ngModel)]="lockedCheckbox"
                                     nzChecked
                                     nz-checkbox
                                     style="margin-right: 12px;">
                                <i class="icon-lock-alt iconRed"></i> Locked
                              </label>
                            </div>
                          </li>
                          <li nz-menu-item>
                            <div class="checkboxInput">
                              <label [(ngModel)]="requiresRegenerationCheckbox"
                                     nzChecked
                                     nz-checkbox
                                     style="margin-right: 12px;">
                                <i class="icon-report_problem_24px iconYellow2"></i> Requires regeneration
                              </label>
                            </div>
                          </li>
                          <li nz-menu-item>
                            <div class="checkboxInput">
                              <label [(ngModel)]="failedCheckbox"
                                     nzChecked
                                     nz-checkbox
                                     style="margin-right: 12px;">
                                <i class="icon-error_24px iconRed2"></i> Failed
                              </label>
                            </div>
                          </li>
                        </ul>
                      </nz-dropdown>
                        <ng-container *ngIf="col?.sorted" [ngSwitch]="sortData[col?.fields]">
                          <i *ngSwitchCase="'asc'" class="icon-keyboard_arrow_up_24px"
                             (click)="sortChange(col?.fields,sortData[col.fields])" style="font-size: 1.4em;"></i>
                          <i *ngSwitchCase="'desc'" class="icon-keyboard_arrow_down_24px"
                             (click)="sortChange(col?.fields,sortData[col.fields])" style="font-size: 1.4em;"></i>
                          <i *ngSwitchDefault class="icon-direction"
                             (click)="sortChange(col?.fields,sortData[col.fields])" style="font-size: 1.4em;"></i>
                        </ng-container>
                      </span>
                    </th>
                    <th *ngIf="col?.icon === 'icon-note'" style="padding: 0 !important;" class="separator-right">
                      <i [ngClass]="col.icon"></i>
                      <span style="display:flex;justify-content: space-between;">
                        <ng-container *ngIf="col?.sorted" [ngSwitch]="sortData[col?.fields]">
                          <i *ngSwitchCase="'asc'" class="icon-keyboard_arrow_up_24px"
                             (click)="sortChange(col?.fields,sortData[col.fields])" style="font-size: 1.4em;"></i>
                          <i *ngSwitchCase="'desc'" class="icon-keyboard_arrow_down_24px"
                             (click)="sortChange(col?.fields,sortData[col.fields])" style="font-size: 1.4em;"></i>
                          <i *ngSwitchDefault class="icon-direction"
                             (click)="sortChange(col?.fields,sortData[col.fields])" style="font-size: 1.4em;"></i>
                        </ng-container>
                      </span>
                    </th>
                    <th *ngIf="col?.fields === 'overallLMF'" style="padding: 0 !important;">
                      <span style="display:flex;justify-content: space-between;">
                        {{col?.header}}
                      </span>
                    </th>
                    <th *ngIf="!col.frozen" [ngStyle]="{'width': col?.width}" style="padding: 0 !important;"
                        [ngClass]="{ 'inuring-header':col.fields=='inuring','draggable': col?.dragable}">
                      <span style="display:flex;justify-content: space-between;">
                        {{col?.header}}
                      </span>
                    </th>
                  </ng-container>
                </tr>
                <tr>
                  <ng-container *ngFor="let col of columns;">
                    <th *ngIf="col?.fields === 'checkbox'">
                    </th>
                    <th *ngIf="col?.fields === 'userTags'">
                    </th>
                    <th *ngIf="col?.filtred && col.extended">
                      <div class="filter-input">
                        <i class="fa fa-search" style="margin: 6px 4px 4px 6px"></i>
                        <input *ngIf="col.header.length > 0" pInputText type="text"
                               (input)="filter(col?.fields, $event.target.value)">
                      </div>
                    </th>
                    <th *ngIf="col?.icon === 'icon-focus-add'"></th>
                    <th *ngIf="col?.icon === 'icon-note'" style="border-right: 8px solid #F4F6FC !important;">
                    </th>
                    <th *ngIf="col?.fields === 'overallLMF'"></th>
                    <th *ngIf="col?.fields === 'base'"></th>
                    <th *ngIf="col?.fields === 'default'"></th>
                    <th *ngIf="col?.fields === 'client'"></th>
                    <th *ngIf="col?.fields === 'inuring'" style="background-color: #FAEBD7 !important;"></th>
                    <th *ngIf="col?.fields === 'postInuring'"></th>
                  </ng-container>
                </tr>
              </ng-template>
              <ng-template pTemplate="body" let-rowIndex="rowIndex" let-rowData let-columns="columns">
                <tr (contextmenu)="selectedItemForMenu=rowData.pltId" [pContextMenuRow]="rowData"
                    [ngClass]="{'active_plt_item': rowData.selected && !rowData.opened, 'opened_plt_item': rowData.opened }"
                    *ngIf="(filters.systemTag.length == 0 ? rowData?.visible :  rowData?.visible && rowData?.tagFilterActive) &&  statusFilterActive(rowData.status)">
                  <td *ngFor="let col of columns; let i = index"
                      dnd-droppable
                      dnd-sortable-container
                      [sortableData]="adjutmentApplication[rowData.pltId]"
                      [dropZones]="['widget-dropZone']"
                      [dragEnabled]="col.fields == 'client' && col.fields == 'base'"
                      (drop)="onDrop(col,rowData.pltId)"
                      [ngClass]="{'draggable':col?.dragable,'fixed':!col?.dragable,'separator-right':col?.icon == 'icon-note','overallLMF':col?.fields == 'overallLMF','data-inuring':col?.fields == 'inuring','data-default':col?.fields == 'default'}"
                      (click)="handlePLTClick(rowData.pltId,rowIndex,$event)">

                    <ng-container *ngIf="col.fields === 'checkbox'">
                      <label nz-checkbox [nzChecked]="rowData.selected"
                             (nzCheckedChange)="selectSinglePLT(rowData.pltId,$event)"></label>
                    </ng-container>
                    <ng-container *ngIf="col.fields === 'userTags'">
                      <div class="td-wrapper-tags">
                        <ng-container *ngFor="let tag of rowData.userTags;let it= index;">
                          <span class="tag-el" *ngIf="it < 2"
                                [ngStyle]="{ 'background-color': tag.tagColor}">&nbsp;</span>
                          <span class="tag-ellipsis" *ngIf="it == 2" style="background-color: #E0E0E0"><i
                            class="icon-ellipsis-h"></i></span>
                        </ng-container>
                      </div>
                    </ng-container>
                    <ng-container *ngIf="col.fields === 'pltId'">
                      <div *ngIf="rowData.status !== 'requires regeneration' || !rowData.newPlt" class="text-elipsice"
                           style="font-weight: bold">{{rowData.pltId | textLength}}</div>
                      <div *ngIf="rowData.status == 'requires regeneration' && rowData.newPlt" class="newTag">NEW</div>
                    </ng-container>
                    <ng-container *ngIf="col?.type == 'field' && !col?.dragable && col.fields  !== 'pltId'">
                      <div class="text-elipsice"
                           [ngStyle]="{'font-weight': i == 2 ? 'bold' : 'normal'}">{{ i == 2 ? (rowData[col.fields]) : rowData[col.fields]}}</div>
                    </ng-container>
                    <ng-container *ngIf="col?.type == 'icon'">
                      <div class="td-wrapper-check">
                        <div *ngIf="col.icon=='icon-focus-add'">
                          <i
                            [ngClass]="{ 'icon-history-alt iconYellow': rowData?.status=='in progress',
                                         'icon-check-circle iconGreen': rowData?.status=='checked' ,
                                         'icon-lock-alt iconRed': rowData?.status=='locked',
                                         'icon-error_24px iconRed2': rowData?.status=='failed',
                                         'icon-report_problem_24px iconYellow2': rowData?.status=='requires regeneration' }">
                          </i>
                        </div>
                        <div *ngIf="col.icon=='icon-note' && !selectedListOfPlts.includes(rowData.pltId)">
                          <nz-dropdown [nzPlacement]="'bottomLeft'">
                            <i class="icon-menu_24px" nz-dropdown
                               style="cursor: pointer; font-size: 25px; float: right; margin-right: 7px"
                               (click)="clickButtonPlus(false,rowData)"></i>
                            <ul nz-menu>
                              <li nz-menu-item>Add New Adjustment</li>
                              <li nz-submenu>
                                <span title>Create</span>
                                <ul nz-menu>
                                  <li nz-menu-item>New Default Thread</li>
                                  <li nz-menu-item>New Non-default Thread</li>
                                </ul>
                              </li>
                              <li nz-submenu>
                                <span title>Clone</span>
                                <ul nz-menu>
                                  <li nz-menu-item>New Default Thread</li>
                                  <li nz-menu-item>New Non-default Thread</li>
                                </ul>
                              </li>
                              <li nz-menu-item>Regenerate</li>
                              <li nz-menu-item>Remove</li>
                              <li nz-menu-item>View PLT Details</li>
                              <li nz-menu-item>Manage Tags</li>
                              <li nz-menu-item>Edit PLT Name</li>
                              <li nz-menu-item>Publish to Princing</li>
                              <li nz-menu-item>Publish to Accumulation</li>
                              <li nz-submenu>
                                <span title>Inuring</span>
                                <ul nz-menu>
                                  <li nz-menu-item>Add to New Inuring Package</li>
                                  <li nz-menu-item>Add to Existing Inuring Package</li>
                                </ul>
                              </li>
                              <li nz-menu-item>Add to Comparer</li>
                              <li nz-menu-item>Export</li>
                              <li nz-menu-item>Delete</li>
                            </ul>
                          </nz-dropdown>
                        </div>
                      </div>
                    </ng-container>
                    <ng-container *ngIf="col?.dragable">
                      <div
                        dnd-sortable-container
                        [sortableData]="adjutmentApplication[rowData.pltId]"
                        [dropZones]="['widget-dropZone']"
                        [dragEnabled]="col.fields == 'client' && col.fields == 'base'"
                        (drop)="onDrop(col,rowData.pltId)"

                        style="display: flex;"
                        class="text-elipsice border-dragable"
                        [ngStyle]="{'font-weight': i == 2 ? 'bold' : 'normal'}">

                        <div *ngIf="col.fields=='default'" style="display: flex;height: max-content">
                          <div
                            class="adjustDiv"
                            style=" background: #f3f3f3;     min-width: 55px !important;    max-width: 55px !important;">
                                          <span
                                            class="spanStyle">Model Calib</span>
                            <input class="templateInput" disabled
                                   style=" background: #f3f3f3;" value="2.1">
                          </div>
                        </div>

                        <ng-container *ngFor="let adjs of adjutmentApplication[rowData.pltId]; let i=index">
                          <ng-container
                            *ngIf="col.fields== adjs.category.toLowerCase()"
                            style="display: flex;height: max-content;">
                            <div dnd-sortable [sortableIndex]="i" [dragEnabled]="true"
                                 [dragData]="adjs" (onDragStart)="draggedAdjs = adjs"
                                 (drop)="onDrop(col,rowData.pltId)"
                                 [ngClass]="{'selectedAdjustment':selectedAdjustment===adjs.ref}"
                                 class="adjustDiv" (mouseover)="shownDropDown = adjs.id+rowData.pltId">
                              <span class="spanStyle"
                                    style="font-weight: normal !important;text-overflow: ellipsis;max-width: 85px;overflow: hidden;display:inline-block;">{{adjs?.name}}</span>
                              <nz-dropdown *ngIf="shownDropDown ===  adjs.id+rowData.pltId"
                                           [nzPlacement]="'bottomLeft'"
                                           class="dropD">
                                <i [id]="threadIndex" class="icon-menu_24px" nz-dropdown
                                   style="font-size: 14px;float: right;margin-right: 2px;"></i>
                                <ul nz-menu>
                                  <li nz-menu-item>Edit</li>
                                  <li nz-menu-item>Branch new Thread</li>
                                  <li nz-menu-item>Copy</li>
                                  <li nz-submenu>
                                    <span title>Paste</span>
                                    <ul nz-menu>
                                      <li nz-menu-item>To the Left</li>
                                      <li nz-menu-item>To the Right</li>
                                    </ul>
                                  </li>
                                  <li nz-menu-item>Delete</li>
                                  <li nz-menu-item>View EP Metrics</li>
                                  <li nz-menu-item>Pin to Chart</li>
                                  <li nz-menu-item>Add to Comparer</li>
                                  <li nz-menu-item>Export</li>
                                </ul>
                              </nz-dropdown>
                              <input class="templateInput" [value]="adjs?.value">
                            </div>
                          </ng-container>
                        </ng-container>

                        <div *ngIf="col.fields=='inuring'" class="adjustDiv"
                             (mouseenter)="shownDropDown = rowData.pltId">
                          <span class="spanStyle"
                                style="font-weight: normal !important;text-overflow: ellipsis;max-width: 85px; overflow: hidden;display:inline-block;"></span>
                          <nz-dropdown *ngIf="shownDropDown === rowData.pltId" [nzPlacement]="'bottomLeft'"
                                       class="dropD">
                            <i [id]="threadIndex" class="icon-menu_24px" nz-dropdown
                               style="font-size: 14px;float: right;margin-right: 2px;"></i>
                            <ul nz-menu>
                              <li nz-menu-item>Edit</li>
                              <li nz-menu-item>Branch new Thread</li>
                              <li nz-menu-item>Copy</li>
                              <li nz-submenu>
                                <span title>Paste</span>
                                <ul nz-menu>
                                  <li nz-menu-item>To the Left</li>
                                  <li nz-menu-item>To the Right</li>
                                </ul>
                              </li>
                              <li nz-menu-item>Delete</li>
                              <li nz-menu-item>View EP Metrics</li>
                              <li nz-menu-item>Pin to Chart</li>
                              <li nz-menu-item>Add to Comparer</li>
                              <li nz-menu-item>Export</li>
                            </ul>
                          </nz-dropdown>
                          <input class="templateInput" disabled
                                 value="P00002">
                        </div>
                        <div *ngIf="dragPlaceHolderId == rowData.pltId && dragPlaceHolderCol == col?.fields"
                             class="dndPlaceholder"></div>
                      </div>
                    </ng-container>
                  </td>
                </tr>
              </ng-template>
            </p-table>
          </div>
        </div>
      </div>

    </div>
  </div>
</div>

<nz-modal [(nzVisible)]="isVisible" [nzFooter]="modalFooter" class="modelAdjustment"
          (nzOnCancel)="handleCancel()"
          [nzTitle]="modalTitle">
  <div nz-row>
    <div class="modal-left-item" nz-col nzSpan="8" style="margin-top: 10px">
      <b>Basis</b>
    </div>
    <div nz-col nzSpan="16">
      <!-- (ngModelChange)="selectCategory(categorySelectedFromBasis)"-->
      <nz-select [(ngModel)]="categorySelectedFromAdjustement"
                 (ngModelChange)="selectCategory(categorySelectedFromAdjustement)"
                 [nzPlaceHolder]="'Select Adjustment'"
                 [nzSize]="size" style="width: 260px;">
        <ng-container *ngFor="let option of allAdjsArray">
          <nz-option *ngIf="option.name!='Default'" [nzLabel]="option.name"
                     [nzValue]="option"></nz-option>
        </ng-container>
      </nz-select>
    </div>
  </div>
  <div nz-row>
    <div nz-col nzSpan="24">
      <nz-collapse *ngIf="categorySelectedFromAdjustement?.description" [nzBordered]="false">
        <nz-collapse-panel [nzHeader]="categorySelectedFromAdjustement?.adjustmentBasis" [nzActive]="true">
          <p>{{categorySelectedFromAdjustement?.description}}</p>
        </nz-collapse-panel>
      </nz-collapse>
    </div>
  </div>
  <div nz-row>
    <div class="modal-left-item" nz-col nzSpan="8">
      <b>Category</b>
    </div>
    <div nz-col nzSpan="16" style="line-height: 2.2rem;">
      <!-- (ngModelChange)="selectCategory(categorySelectedFromBasis)"-->
      <b style="margin-left: 10px;">{{categorySelected}}</b>
    </div>
  </div>
  <div nz-row>
    <div nz-col nzSpan="24">
      &nbsp;
    </div>
  </div>
  <div nz-row>
    <div class="modal-left-item" nz-col nzSpan="8" style="margin-top: 10px">
      <b>Narrative</b>
    </div>
    <div nz-col nzSpan="16">
      <textarea style="margin-left: 10px; width: 95%" rows="4" nz-input [(ngModel)]="inputValue"></textarea>
    </div>
  </div>
  <div nz-row>
    <div nz-col nzSpan="24">
      &nbsp;
    </div>
  </div>
  <div nz-row>
    <div class="modal-left-item" nz-col nzSpan="8" style="margin-top: 10px">
      <b>Type</b>
    </div>
    <div nz-col nzSpan="16">
      <nz-select [(ngModel)]="singleValue" (ngModelChange)="selectBasis(singleValue)"
                 [nzPlaceHolder]="'choose Type'"
                 [nzSize]="size" style="width: 260px;">
        <nz-option *ngFor="let option of AdjustementType" [nzLabel]="option.name" [nzValue]="option"></nz-option>
      </nz-select>
    </div>
  </div>
  <div nz-row style="margin-top: 20px;" *ngIf="categorySelectedFromAdjustement">
    <div class="modal-left-item" nz-col nzSpan="8" style="margin: 5px;">
      Capped
    </div>
    <div nzSpan="16" style="line-height: 2.2rem;">
      <nz-switch [nzDisabled]="true" [ngModel]="categorySelectedFromAdjustement?.exposureFlag == 'CAP'" nzSize="small"
                 style="margin-left: 15px;"></nz-switch>
    </div>
  </div>

  <ng-container *ngIf="linear">
    <div nz-row>
      <div nz-col nzSpan="24" style="margin: 5px;">
        <hr>
      </div>
    </div>
    <div nz-row>
      <div nz-col nzSpan="24" style="margin: 5px;">
        <b>Parameter</b>
      </div>
    </div>
    <div nz-row>
      <div nz-col nzSpan="2">
        &nbsp;
      </div>
      <div nz-col nzSpan="11">
        Loss Modification Factor (LMF)
      </div>
      <div nz-col nzSpan="9">
        <input
          #inputElement
          [(ngModel)]="columnPosition"
          nz-input
          nz-tooltip
          style="width: 200px;
        height: 40px;
        background: #f9f9f9;
        border-radius: 0;
        border:0;
        border-bottom: 1px solid black;
        color:#0700CF"
        />
      </div>
    </div>
  </ng-container>
  <ng-template #modalFooter>
    <button (click)="handleCancel()"
            class="ant-btn"
            style="color: rgba(82,89,95,0.68); margin-right: 20px; border: none; width: 100px;height: 30px; "> CANCEL
    </button>

    <button *ngIf="!modifyModal" (click)="addAdjustmentFromPlusIcon(true,singleValue,categorySelectedFromAdjustement)"
            class="ant-btn ant-btn-default"
            style="width: 130px; height: 30px; ">SAVE
    </button>
    <button *ngIf="modifyModal" (click)="saveAdjModification(categorySelectedFromAdjustement)"
            class="ant-btn ant-btn-default"
            style="width: 130px; height: 30px; ">SAVE
    </button>
  </ng-template>
</nz-modal>



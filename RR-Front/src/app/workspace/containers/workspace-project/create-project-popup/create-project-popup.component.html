<p-dialog [(visible)]="isVisible"
          [modal]="true"
          [closable]="false"
          [contentStyle]="{'overflow':'visible'}"
          [styleClass]="'m-dialog-modal-sm-f'"
          [responsive]="true"
          (onHide)="cancelCreateProject()"
          (onShow)="patchNewProject()"
>

  <p-header>
    <span *ngIf="!editOption" style="margin-left: 10px">Create <span
      *ngIf="newProjectForm.controls['projectId'].value">Linked</span>
        <span *ngIf="!newProjectForm.controls['projectId'].value">New</span> Project
    </span>
    <span *ngIf="editOption" style="margin-left: 10px">Edit Project</span>
    <span (click)="cancelCreateProject()" style="float: right; cursor: pointer;">&#10006;</span>
  </p-header>
  <div class="a-info-card">
    <div style="background: #4E80F5"
         class="project-header-icon d-flex justify-content-center align-items-center">
      <i class="icon-window-section"></i>
    </div>
    <div class="a-info-card-data">
      <div class="a-info-data-left">
        <span class="a-info-title">{{workspace?.cedantName}}</span>
        <span class="a-info-subtitle">{{workspace?.uwYear}} - {{workspace?.workspaceName}}</span>
      </div>
      <div class="a-info-data-right"><span class="a-info-caption">{{workspace?.workSpaceId}}</span></div>
    </div>
  </div>
  <div class="a-form-control" *ngIf="!editOption" [formGroup]="newProjectForm" style="margin-top: 16px;">
    <div *ngIf="newProjectForm.controls['projectId'].value" class="a-form-input-wrapper">
      <label class="label-input">Project ID</label>
      <input style="margin-bottom:15px" class="a-textfield-standard a-textfield-label" [attr.disabled]="true"
             placeholder="Project ID" formControlName="projectId"/>
    </div>
    <div class="a-form-input-wrapper">
      <label class="label-input">Project Name</label>
      <input style="margin-bottom:15px" class="a-textfield-standard a-textfield-label"
             placeholder="Insert Name" formControlName="projectName"/>
    </div>

    <div class="a-form-input-wrapper">
      <label class="textarea-label">Description</label>
      <textarea style="margin-bottom:15px;" rows="4" nz-input placeholder="Insert Description"
                formControlName="projectDescription"></textarea>
    </div>

    <div class="a-form-input-wrapper">
      <label class="label-input">Created By</label>
      <input class="a-textfield-standard a-textfield-label a-textfield-disabled"
             [attr.disabled]="true" placeholder="Insert Name" formControlName="createdBy"/>
    </div>

    <div class="a-form-date-control a-datepicker-standard">
      <div class="a-form-input-wrapper">
        <label class="label-input">Reception Date</label>
        <p-calendar formControlName="receptionDate" appendTo="body" placeholder="Select Date"
                    [showIcon]="true"></p-calendar>
      </div>
      <div class="a-form-input-wrapper">
        <label class="label-input">Due Date</label>
        <p-calendar formControlName="dueDate" appendTo="body" placeholder="Select Date" [showIcon]="true"></p-calendar>
      </div>
    </div>

  </div>

  <div class="a-form-control" *ngIf="editOption" style="margin-top: 16px;">
    <div *ngIf="newProjectForm.controls['projectId'].value" class="a-form-input-wrapper">
      <label class="label-input">Project ID</label>
      <input style="margin-bottom:15px" class="a-textfield-standard a-textfield-label" [attr.disabled]="true"
             placeholder="Project ID" [(ngModel)]="projectForm.projectId"/>
    </div>
    <div class="a-form-input-wrapper">
      <label class="label-input">Project Name</label>
      <input style="margin-bottom:15px" class="a-textfield-standard a-textfield-label" placeholder="Insert Name"
             [(ngModel)]="projectForm.projectName" [disabled]="projectForm.projectType === 'FAC'"/>
    </div>

    <div class="a-form-input-wrapper">
      <label class="textarea-label">Description</label>
      <textarea style="margin-bottom:15px;" rows="4" nz-input
                placeholder="Insert Description" [(ngModel)]="projectForm.projectDescription"></textarea>
    </div>

    <div class="a-form-input-wrapper">
      <label class="label-input">Assigned To</label>
      <nz-select class="a-dropdown-label" [(ngModel)]="projectForm.assignedTo">
        <nz-option *ngFor="let user of users" [nzLabel]="user?.firstName + ' ' + user?.lastName" [nzValue]="user?.userId"></nz-option>
      </nz-select>
    </div>

    <div class="a-form-date-control a-datepicker-standard">
      <div class="a-form-input-wrapper">
        <label class="label-input">Reception Date</label>
        <p-calendar [(ngModel)]="projectForm.receptionDate" appendTo="body"
                    placeholder="Select Date" [showIcon]="true" [disabled]="projectForm.projectType === 'FAC'">

        </p-calendar>
      </div>
      <div class="a-form-input-wrapper">
        <label class="label-input">Due Date</label>
        <p-calendar [(ngModel)]="projectForm.dueDate" appendTo="body"
                    placeholder="Select Date" [showIcon]="true" [disabled]="projectForm.projectType === 'FAC'">

        </p-calendar>
      </div>
    </div>

  </div>

  <p-footer>
    <div class="a-control-buttons">
      <button class="a-button-text-cancel" (click)="cancelCreateProject()">CANCEL</button>
      <button [ngClass]="{'a-buttons-contained-disabled' : !checkValid(), 'a-buttons-contained': checkValid()}"
              *ngIf="editOption" [disabled]="!checkValid()" (click)="updateProject()">SAVE
      </button>
      <button
        [ngClass]="{'a-buttons-contained-disabled' : !newProjectForm.valid, 'a-buttons-contained': newProjectForm.valid}"
        *ngIf="!editOption" [disabled]="!newProjectForm.valid" (click)="createUpdateProject()">CREATE
      </button>
    </div>
  </p-footer>
</p-dialog>
